(function(){function n(){var a=document.head.querySelector('link[rel="manifest"]'),b=a?a.href:"",c=A([b,window.location]);Promise.resolve().then(function(){if(!b)throw'can\'t find <link rel="manifest" href=".." />\'';var a={};"use-credentials"===b.crossOrigin&&(a.credentials="include");return window.fetch(b,a)}).then(function(a){return a.json()}).then(function(a){return B(a,c)}).catch(function(a){return console.warn("pwacompat.js error",a)})}function A(a){for(var b={},c=0;c<a.length;b={c:b.c},++c){b.c=
a[c];try{return new URL("",b.c),function(a){return function(b){return(new URL(b,a.c)).toString()}}(b)}catch(d){}}return function(a){return a}}function t(a,b){a=document.createElement(a);for(var c in b)a.setAttribute(c,b[c]);document.head.appendChild(a);return a}function e(a,b){b&&(!0===b&&(b="yes"),t("meta",{name:a,content:b}))}function B(a,b){function c(b,c,g){var e=b.width,d=b.height;b=window.devicePixelRatio;var f=u({width:e*b,height:d*b});f.scale(b,b);f.fillStyle=a.background_color||"#f8f9fa";
f.fillRect(0,0,e,d);f.translate(e/2,(d-32)/2);g&&(d=g.width/b,b=g.height/b,128<b&&(d/=b/128,b=128),48<=d&&48<=b&&(f.drawImage(g,d/-2,b/-2,d,b),f.translate(0,b/2+32)));f.fillStyle=n?"white":"black";f.font="24px HelveticaNeue-CondensedBold";g=a.name||a.short_name||document.title;b=f.measureText(g).width;if(b<.8*e)f.fillText(g,b/-2,0);else for(g=g.split(/\s+/g),b=1;b<=g.length;++b){d=g.slice(0,b).join(" ");var v=f.measureText(d).width;if(b===g.length||v>.6*e)f.fillText(d,v/-2,0),f.translate(0,24*1.2),
g.splice(0,b),b=0}return function(){var a=document.createElement("link");a.setAttribute("rel","apple-touch-startup-image");a.setAttribute("media","(orientation: "+c+")");a.setAttribute("href",f.canvas.toDataURL());return a}}function d(a){var b=c(window.screen,"portrait",a),d=c({width:window.screen.height,height:window.screen.width},"landscape",a);window.setTimeout(function(){document.head.appendChild(b());window.setTimeout(function(){document.head.appendChild(d())},10)},10)}var h=a.icons||[];h.sort(function(a,
b){return parseInt(b.sizes,10)-parseInt(a.sizes,10)});var l=h.map(function(a){var c={rel:"icon",href:b(a.src),sizes:a.sizes};t("link",c);if(p&&!(120>parseInt(a.sizes,10)))return c.rel="apple-touch-icon",t("link",c)}).filter(Boolean);l.length&&l[l.length-1].removeAttribute("sizes");h=document.head.querySelector('meta[name="viewport"]');var q=!!(h&&h.content||"").match(/\bviewport-fit\s*=\s*cover\b/),r=a.display;h=-1!==C.indexOf(r);e("mobile-web-app-capable",h);D(a.theme_color||"black",q);E&&(e("application-name",
a.short_name),e("msapplication-tooltip",a.description),e("msapplication-starturl",a.start_url||"/"),e("msapplication-TileColor",a.theme_color));document.head.querySelector('[name="theme-color"]')||e("theme-color",a.theme_color);if(p){var n=w(a.background_color||"#f8f9fa");(r=F(a.related_applications))&&e("apple-itunes-app","app-id="+r);e("apple-mobile-web-app-capable",h);e("apple-mobile-web-app-title",a.short_name||a.name);var m=l[0],k=new Image;k.crossOrigin="anonymous";k.onerror=function(){d()};
if(l.length)k.onload=function(){d(k);if(a.background_color){var b=x(k,a.background_color);b&&(m.href=b,l.slice(1).forEach(function(b){var c=new Image;c.crossOrigin="anonymous";c.onload=function(){var d=x(c,a.background_color,!0);b.href=d};c.src=b.href}))}},k.src=m.href;else k.onerror()}else q={por:"portrait",lan:"landscape"}[String(a.orientation||"").substr(0,3)]||"",e("x5-orientation",q),e("screen-orientation",q),"fullscreen"===r?(e("x5-fullscreen","true"),e("full-screen","yes")):h&&(e("x5-page-mode",
"app"),e("browsermode","application"))}function F(a){var b;(a||[]).filter(function(a){return"itunes"===a.platform}).forEach(function(a){a.id?b=a.id:(a=a.url.match(/id(\d+)/))&&(b=a[1])});return b}function D(a,b){if(p||G){var c=w(a);if(p)e("apple-mobile-web-app-status-bar-style",b?"black-translucent":c?"black":"default");else{a:{try{var d=Windows.UI.ViewManagement.ApplicationView.getForCurrentView().titleBar;break a}catch(h){}d=void 0}if(b=d)b.foregroundColor=m(c?"black":"white"),b.backgroundColor=
m(a)}}}function m(a){a=y(a);return{r:a[0],g:a[1],b:a[2],a:a[3]}}function y(a){var b=u();b.fillStyle=a;b.fillRect(0,0,1,1);return b.getImageData(0,0,1,1).data}function w(a){a=y(a).map(function(a){a/=255;return.03928>a?a/12.92:Math.pow((a+.055)/1.055,2.4)});return 3<Math.abs(1.05/(.2126*a[0]+.7152*a[1]+.0722*a[2]+.05))}function x(a,b,c){c=void 0===c?!1:c;var d=u(a);d.drawImage(a,0,0);if(c||255!=d.getImageData(0,0,1,1).data[3])return d.globalCompositeOperation="destination-over",d.fillStyle=b,d.fillRect(0,
0,a.width,a.height),d.canvas.toDataURL()}function u(a){a=void 0===a?{width:1,height:1}:a;var b=a.height,c=document.createElement("canvas");c.width=a.width;c.height=b;return c.getContext("2d")}if("fetch"in window&&!navigator.f){var C=["standalone","fullscreen","minimal-ui"],z=navigator.userAgent||"",p=navigator.vendor&&-1!==navigator.vendor.indexOf("Apple")&&-1!==z.indexOf("Mobile/"),E=-1!==z.indexOf("Edge"),G="undefined"!==typeof Windows;"complete"===document.readyState?n():window.addEventListener("load",
n)}})();
